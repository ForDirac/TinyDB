from table.b_tree import Node, Pair
from table import Key
from DBMS import DBMS


if __name__ == '__main__':
    # root = Node(is_root=True)
    # p = Pair((3,'2004-04-06'), [1])
    # root = root.insert(p)
    # p = Pair((5,'2005-03-24'), [2])
    # root = root.insert(p)
    # p = Pair((5,'2005-03-24'), [3])
    # root = root.insert(p)
    # p = Pair((5,'2004-07-14'), [4])
    # root = root.insert(p)
    # p = Pair((2,'2005-09-01'), [5])
    # root = root.insert(p)
    # p = Pair((1,'2002-09-01'), [6])
    # root = root.insert(p)
    # p = Pair((1,'2002-09-01'), [7])
    # root = root.insert(p)
    # p = Pair((5,'2005-09-01'), [8])
    # root = root.insert(p)
    # p = Pair((5,'2006-09-01'), [9])
    # root = root.insert(p)
    # p = Pair((6,'2004-09-01'), [10])
    # root = root.insert(p)
    # p = Pair((6,'2004-10-01'), [11])
    # root = root.insert(p)
    # root.show(depth=0)
    print("\n----INSERT result----")
    db = DBMS((Key('rating'), Key('date'), 'mid', 'uid'))
    db.insert((3, '2004-04-06', '1', '12'))
    db.insert((5, '2005-03-24', '2', '23'))
    db.insert((5, '2005-03-24', '3', '34'))
    db.insert((4, '2004-07-14', '4', '45'))
    db.show()
    print("\n----SEARCH result----")
    results = db.search((5, '2005-03-24'))
    for result in results:
        print(result)
    print("\n----DELETE result----")
    db.delete(2)
    db.show()
    print("\n----UPDATE result----")
    db.update(1, (5, '2005-03-24', '2', '23'))
    db.show()
